(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","Slick","nf.Common","nf.ErrorHandler"],function(c,f,d,e){return(nf.HistoryModel=b(c,f,d,e))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.HistoryModel=b(require("jquery"),require("Slick"),require("nf.Common"),require("nf.ErrorHandler")))}else{nf.HistoryModel=b(a.$,a.Slick,a.nf.Common,a.nf.ErrorHandler)}}}(this,function(f,u,j,h){var i=50;var v={length:0};var q={};var a=null;var n=1;var e=null;var k=null;var t=new u.Event();var p=new u.Event();var l=function(y,x){for(var w=y;w<=x;w++){if(v[w]===undefined||v[w]===null){return false}}return true};var s=function(){for(var w in v){delete v[w]}v.length=0};var d=function(B,A){if(k){k.abort();for(var w=k.fromPage;w<=k.toPage;w++){v[w*i]=undefined}}if(B<0){B=0}var z=Math.floor(B/i);var x=Math.floor(A/i);while(v[z*i]!==undefined&&z<x){z++}while(v[x*i]!==undefined&&z<x){x--}if(z>x||((z===x)&&v[z*i]!==undefined)){return}var y={};y=f.extend({count:((x-z)*i)+i,offset:z*i},y);if(a!==null){y.sortColumn=a;y.sortOrder=(n>0)?"asc":"desc"}y=f.extend(y,q);if(e!==null){clearTimeout(e)}e=setTimeout(function(){for(var C=z;C<=x;C++){v[C*i]=null}t.notify({from:B,to:A});var D=f.ajax({type:"GET",url:"../nifi-api/flow/history",data:y,dataType:"json"}).done(function(E){var G=E.history;var I=z*i;var H=I+G.actions.length;v.length=G.total;for(var F=0;F<G.actions.length;F++){v[I+F]=G.actions[F];v[I+F].index=I+F}f("#history-last-refreshed").text(G.lastRefreshed);f(".timezone").text(j.substringAfterLast(G.lastRefreshed," "));if(y.sourceId||y.userIdentity||y.startDate||y.endDate){f("#history-filter-overview").css("visibility","visible")}else{f("#history-filter-overview").css("visibility","hidden")}D=null;p.notify({from:I,to:H})}).fail(h.handleAjaxError);D.fromPage=z;D.toPage=x},50)};var g=function(y,x){for(var w=y;w<=x;w++){delete v[w]}d(y,x)};var c=function(x,w){a=x;n=w;s()};var r=function(w){q=w;s()};var m=function(w){return v[w]};var b=function(){return v.length};function o(){}o.prototype={constructor:o,data:v,clear:s,isDataLoaded:l,ensureData:d,reloadData:g,setSort:c,setFilterArgs:r,getItem:m,getLength:b,onDataLoading:t,onDataLoaded:p};return o}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common","nf.Dialog","nf.UsersTable","nf.ErrorHandler","nf.Storage","nf.Client"],function(f,g,e,i,h,d,c){return(nf.Users=b(f,g,e,i,h,d,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Users=b(require("jquery"),require("nf.Common"),require("nf.Dialog"),require("nf.UsersTable"),require("nf.ErrorHandler"),require("nf.Storage"),require("nf.Client")))}else{nf.Users=b(a.$,a.nf.Common,a.nf.Dialog,a.nf.UsersTable,a.nf.ErrorHandler,a.nf.Storage,a.nf.Client)}}}(this,function(g,d,e,a,i,h,m){g(document).ready(function(){j.init();if(top===window){g("#users").css("top",20);g("#users-refresh-container").css("bottom",20)}});var b={urls:{banners:"../nifi-api/flow/banners",controllerAbout:"../nifi-api/flow/about",currentUser:"../nifi-api/flow/current-user",flowConfig:"../nifi-api/flow/config"}};var c=function(){return g.ajax({type:"GET",url:b.urls.currentUser,dataType:"json"}).done(function(n){d.setCurrentUser(n)}).fail(i.handleAjaxError)};var l=function(){return g.ajax({type:"GET",url:b.urls.flowConfig,dataType:"json"}).fail(i.handleAjaxError)};var f=function(){return g.Deferred(function(n){if(top!==window&&d.isDefinedAndNotNull(parent.nf)&&d.isDefinedAndNotNull(parent.nf.Storage)){n.resolve(parent.nf.Storage.isDisconnectionAcknowledged())}else{g.ajax({type:"GET",url:"../nifi-api/flow/cluster/summary",dataType:"json"}).done(function(o){var p=o;var q=p.clusterSummary;if(q.connectedToCluster){n.resolve(false)}else{if(q.clustered){e.showDisconnectedFromClusterMessage(function(){n.resolve(true)})}else{n.resolve(false)}}}).fail(i.handleAjaxError).fail(function(){n.reject()})}}).promise()};var k=function(){d.addHoverEffect("#user-refresh-button","button-refresh","button-refresh-hover").click(function(){a.loadUsersTable()});return g.Deferred(function(n){if(top===window){g.ajax({type:"GET",url:b.urls.banners,dataType:"json"}).done(function(s){if(d.isDefinedAndNotNull(s.banners)){if(d.isDefinedAndNotNull(s.banners.headerText)&&s.banners.headerText!==""){var p=g("#banner-header").text(s.banners.headerText).show();var r=function(t){var u=g("#"+t);u.css("top",(parseInt(p.css("height"),10)+parseInt(u.css("top"),10))+"px")};r("users")}if(d.isDefinedAndNotNull(s.banners.footerText)&&s.banners.footerText!==""){var o=g("#banner-footer").text(s.banners.footerText).show();var q=function(t){var u=g("#"+t);u.css("bottom",parseInt(o.css("height"),10)+"px")};q("users")}}n.resolve()}).fail(function(q,o,p){i.handleAjaxError(q,o,p);n.reject()})}else{n.resolve()}})};var j={init:function(){h.init();m.init();g.when(l(),f(),c()).done(function(p,o){var q=p[0];var n=q.flowConfiguration;a.init(n.supportsConfigurableUsersAndGroups,o);a.loadUsersTable().done(function(){k().done(function(){g(window).resize(a.resetTableSize);a.resetTableSize();g.ajax({type:"GET",url:b.urls.controllerAbout,dataType:"json"}).done(function(s){var r=s.about;var t=r.title+" Users";document.title=t;g("#users-header-text").text(t)}).fail(i.handleAjaxError)});g(window).on("resize",function(w){var v=g(".dialog");for(var t=0,r=v.length;t<r;t++){if(g(v[t]).is(":visible")){setTimeout(function(x){x.modal("resize")},50,g(v[t]))}}var u=g('*[class*="slickgrid_"]');for(var s=0,r=u.length;s<r;s++){if(g(u[s]).is(":visible")){setTimeout(function(x){x.data("gridInstance").resizeCanvas()},50,g(u[s]))}}})})})}};return j}));
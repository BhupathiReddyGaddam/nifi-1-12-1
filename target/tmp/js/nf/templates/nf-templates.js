(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common","nf.Dialog","nf.TemplatesTable","nf.ErrorHandler","nf.Storage"],function(f,g,e,d,h,c){return(nf.Templates=b(f,g,e,d,h,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Templates=b(require("jquery"),require("nf.Common"),require("nf.Dialog"),require("nf.TemplatesTable"),require("nf.ErrorHandler"),require("nf.Storage")))}else{nf.Templates=b(a.$,a.nf.Common,a.nf.Dialog,a.nf.TemplatesTable,a.nf.ErrorHandler,a.nf.Storage)}}}(this,function(g,d,e,k,i,h){g(document).ready(function(){b.init()});var c={urls:{banners:"../nifi-api/flow/banners",about:"../nifi-api/flow/about",currentUser:"../nifi-api/flow/current-user"}};var j=function(){return g.ajax({type:"GET",url:c.urls.currentUser,dataType:"json"}).done(function(l){d.setCurrentUser(l)}).fail(i.handleAjaxError)};var f=function(){return g.Deferred(function(l){if(top!==window&&d.isDefinedAndNotNull(parent.nf)&&d.isDefinedAndNotNull(parent.nf.Storage)){l.resolve(parent.nf.Storage.isDisconnectionAcknowledged())}else{g.ajax({type:"GET",url:"../nifi-api/flow/cluster/summary",dataType:"json"}).done(function(m){var n=m;var o=n.clusterSummary;if(o.connectedToCluster){l.resolve(false)}else{if(o.clustered){e.showDisconnectedFromClusterMessage(function(){l.resolve(true)})}else{l.resolve(false)}}}).fail(i.handleAjaxError).fail(function(){l.reject()})}}).promise()};var a=function(){g("#refresh-button").click(function(){k.loadTemplatesTable()});return g.Deferred(function(l){if(top===window){g.ajax({type:"GET",url:c.urls.banners,dataType:"json"}).done(function(q){if(d.isDefinedAndNotNull(q.banners)){if(d.isDefinedAndNotNull(q.banners.headerText)&&q.banners.headerText!==""){var n=g("#banner-header").text(q.banners.headerText).show();var p=function(r){var s=g("#"+r);s.css("top",(parseInt(n.css("height"),10)+parseInt(s.css("top"),10))+"px")};p("templates")}if(d.isDefinedAndNotNull(q.banners.footerText)&&q.banners.footerText!==""){var m=g("#banner-footer").text(q.banners.footerText).show();var o=function(r){var s=g("#"+r);s.css("bottom",parseInt(m.css("height"),10)+"px")};o("templates")}}l.resolve()}).fail(function(o,m,n){i.handleAjaxError(o,m,n);l.reject()})}else{l.resolve()}}).promise()};var b={init:function(){h.init();g.when(f(),j()).done(function(l){k.init(l);k.loadTemplatesTable().done(function(){a().done(function(){var m=function(){if(top===window){g("body").css({height:g(window).height()+"px",width:g(window).width()+"px"});g("#templates").css("margin",40);g("#templates-table").css("bottom",127);g("#templates-refresh-container").css("margin",40)}k.resetTableSize()};g.ajax({type:"GET",url:c.urls.about,dataType:"json"}).done(function(o){var n=o.about;var p=n.title+" Templates";document.title=p;g("#templates-header-text").text(p);m()}).fail(i.handleAjaxError);g(window).on("resize",function(u){m();var n=g(".dialog");for(var s=0,t=n.length;s<t;s++){if(g(n[s]).is(":visible")){setTimeout(function(w){w.modal("resize")},50,g(n[s]))}}var v=g('*[class*="slickgrid_"]');for(var r=0,t=v.length;r<t;r++){if(g(v[r]).is(":visible")){setTimeout(function(w){w.data("gridInstance").resizeCanvas()},50,g(v[r]))}}var p=g(".tab-container");var o=[];for(var q=0,t=p.length;q<t;q++){if(g(p[q]).is(":visible")){o.push(g("#"+g(p[q]).attr("id")+"-content"))}}g.each(o,function(w,x){d.toggleScrollable(x.get(0))})})})})})}};return b}));
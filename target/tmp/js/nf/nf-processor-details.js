(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common","nf.UniversalCapture","nf.Dialog","nf.ErrorHandler","nf.CustomUi","nf.ClusterSummary","nf.CanvasUtils"],function(g,h,j,f,i,e,c,d){return(nf.ProcessorDetails=b(g,h,j,f,i,e,c,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ProcessorDetails=b(require("jquery"),require("nf.Common"),require("nf.UniversalCapture"),require("nf.Dialog"),require("nf.ErrorHandler"),require("nf.CustomUi"),require("nf.ClusterSummary"),require("nf.CanvasUtils")))}else{nf.ProcessorDetails=b(a.$,a.nf.Common,a.nf.UniversalCapture,a.nf.Dialog,a.nf.ErrorHandler,a.nf.CustomUi,a.nf.ClusterSummary,a.nf.CanvasUtils)}}}(this,function(e,b,f,d,g,h,i,c){var a;var j=function(n){var k=e('<div class="relationship-name ellipsis"></div>').text(n.name);if(n.autoTerminate===true){k.css("font-weight","bold")}var m=e('<div class="processor-relationship-container"></div>').append(k).appendTo("#read-only-auto-terminate-relationship-names");if(!b.isBlank(n.description)){var l=e('<div class="relationship-description"></div>').text(n.description);m.append(l)}return m};return{init:function(k){a=k;e("#processor-details-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"Settings",tabContentId:"details-standard-settings-tab-content"},{name:"Scheduling",tabContentId:"details-scheduling-tab-content"},{name:"Properties",tabContentId:"details-processor-properties-tab-content"},{name:"Comments",tabContentId:"details-processor-comments-tab-content"}],select:function(){f.removeAllPropertyDetailDialogs();if(e(this).text()==="Properties"){e("#read-only-processor-properties").propertytable("resetTableSize")}var l=e("#read-only-auto-terminate-relationship-names");if(l.is(":visible")&&l.get(0).scrollHeight>Math.round(l.innerHeight())){l.css("border-width","1px")}}});e("#processor-details").modal({headerText:"Processor Details",scrollableContentStyle:"scrollable",handler:{close:function(){e("#read-only-auto-terminate-relationship-names").css("border-width","0").empty();e("#read-only-processor-properties").propertytable("clear");b.clearField("read-only-processor-id");b.clearField("read-only-processor-type");b.clearField("read-only-processor-name");b.clearField("read-only-concurrently-schedulable-tasks");b.clearField("read-only-scheduling-period");b.clearField("read-only-penalty-duration");b.clearField("read-only-yield-duration");b.clearField("read-only-run-duration");b.clearField("read-only-bulletin-level");b.clearField("read-only-execution-node");b.clearField("read-only-execution-status");b.clearField("read-only-processor-comments");e("#processor-details").removeData("processorDetails");e("#processor-details").removeData("processorHistory");if(a.supportsStatusBar){e("#processor-details-status-bar").statusbar("disconnect")}},open:function(){b.toggleScrollable(e("#"+this.find(".tab-container").attr("id")+"-content").get(0))}}});if(a.supportsStatusBar){e("#processor-details-status-bar").statusbar()}e("#read-only-processor-properties").propertytable(Object.assign({supportsGoTo:a.supportsGoTo,readOnly:true},c&&{getParameterContext:function(l){return c.getParameterContext()}}))},showDetails:function(m,n){var l=e.ajax({type:"GET",url:"../nifi-api/processors/"+encodeURIComponent(n),dataType:"json"}).done(function(p){if(b.isDefinedAndNotNull(p.component)){var q=p.component;e("#processor-details").data("processorDetails",q);b.populateField("read-only-processor-id",q.id);b.populateField("read-only-processor-type",b.formatType(q));b.populateField("read-only-processor-bundle",b.formatBundle(q.bundle));b.populateField("read-only-processor-name",q.name);b.populateField("read-only-concurrently-schedulable-tasks",q.config.concurrentlySchedulableTaskCount);b.populateField("read-only-scheduling-period",q.config.schedulingPeriod);b.populateField("read-only-penalty-duration",q.config.penaltyDuration);b.populateField("read-only-yield-duration",q.config.yieldDuration);b.populateField("read-only-run-duration",b.formatDuration(q.config.runDurationMillis));b.populateField("read-only-bulletin-level",q.config.bulletinLevel);b.populateField("read-only-processor-comments",q.config.comments);var o=true;var s=q.config.schedulingStrategy;if(s==="EVENT_DRIVEN"){o=false;s="Event driven"}else{if(s==="CRON_DRIVEN"){s="CRON driven"}else{if(s==="TIMER_DRIVEN"){s="Timer driven"}else{s="On primary node"}}}b.populateField("read-only-scheduling-strategy",s);if(o===true){e("#read-only-run-schedule").show()}else{e("#read-only-run-schedule").hide()}var r=q.config.executionNode;if(r==="ALL"){r="All nodes"}else{if(r==="PRIMARY"){r="Primary node only"}}b.populateField("read-only-execution-node",r);e("#read-only-execution-node-options").show();if(!b.isEmpty(q.relationships)){e.each(q.relationships,function(t,u){j(u)})}else{e("#read-only-auto-terminate-relationship-names").append('<div class="unset">This processor has no relationships.</div>')}}});var k=e.ajax({type:"GET",url:"../nifi-api/flow/history/components/"+encodeURIComponent(n),dataType:"json"}).done(function(o){var p=o.componentHistory;e("#processor-details").data("processorHistory",p)});e.when(l,k).done(function(t,x){var u=t[0];var p=u.component;var w=x[0];var r=w.componentHistory;var v;e("#read-only-processor-properties").propertytable("setGroupId",p.parentGroupId).propertytable("loadProperties",p.config.properties,p.config.descriptors,r.propertyHistory);var s=[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){e("#processor-details").modal("hide")}}}];if(top===window&&b.isDefinedAndNotNull(h)&&b.isDefinedAndNotNull(p.config.customUiUrl)&&p.config.customUiUrl!==""){s.push({buttonText:"Advanced",clazz:"fa fa-cog button-icon",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){e("#processor-details").modal("hide");h.showCustomUi(u,p.config.customUiUrl,false)}}})}if(a.supportsStatusBar&&b.isDefinedAndNotNull(a.nfCanvasUtils)){e("#processor-details-status-bar").statusbar("observe",p.id);v=a.nfCanvasUtils.getSelectionById(p.id);if(b.isDefinedAndNotNull(a.nfActions)&&a.nfCanvasUtils.isProcessor(v)&&a.nfCanvasUtils.canModify(v)){var q=function(){var y=e("#processor-details-tabs").find(".selected-tab").text();e("#processor-configuration-tabs").find('.tab:contains("'+y+'")').trigger("click");e("#processor-details").modal("hide");e("#processor-details-status-bar").statusbar("showButtons")};e("#processor-details-status-bar").statusbar("buttons",[{buttonHtml:'<i class="fa fa-stop stop-configure-icon" aria-hidden="true"></i><span>Stop & Configure</span>',clazz:"button button-icon auto-width",color:{hover:"#C7D2D7",base:"transparent",text:"#004849"},disabled:function(){return !a.nfCanvasUtils.isStoppable(v)},handler:{click:function(){e("#processor-details-status-bar").statusbar("hideButtons");a.nfActions.stopAndConfigure(v,q)}}},{buttonText:"Configure",clazz:"fa fa-cog button-icon",color:{hover:"#C7D2D7",base:"transparent",text:"#004849"},disabled:function(){return a.nfCanvasUtils.isStoppable(v)},handler:{click:function(){e("#processor-details-status-bar").statusbar("hideButtons");a.nfActions.showConfiguration(v,q)}}}])}}e("#processor-details").modal("setButtonModel",s).modal("show");e("#processor-details div.relationship-name").ellipsis();var o=e("#read-only-auto-terminate-relationship-names");if(o.is(":visible")&&o.get(0).scrollHeight>Math.round(o.innerHeight())){o.css("border-width","1px")}}).fail(g.handleAjaxError)}}}));
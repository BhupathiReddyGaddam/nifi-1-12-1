(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.CanvasUtils","nf.Common","nf.Dialog","nf.Storage","nf.Client","nf.ErrorHandler","nf.Clipboard","nf.ParameterContexts","nf.Snippet","nf.GoTo","nf.ng.Bridge","nf.Shell","nf.VariableRegistry","nf.ComponentState","nf.FlowVersion","nf.Draggable","nf.Birdseye","nf.Connection","nf.Graph","nf.ProcessGroupConfiguration","nf.ProcessorConfiguration","nf.ProcessorDetails","nf.LabelConfiguration","nf.RemoteProcessGroupConfiguration","nf.RemoteProcessGroupDetails","nf.PortConfiguration","nf.PortDetails","nf.ConnectionConfiguration","nf.ConnectionDetails","nf.PolicyManagement","nf.RemoteProcessGroup","nf.Label","nf.Processor","nf.RemoteProcessGroupPorts","nf.ComponentVersion","nf.QueueListing","nf.StatusHistory"],function(C,H,L,G,l,t,j,f,y,N,M,h,m,F,k,g,u,w,i,O,p,E,K,e,z,B,J,D,q,n,o,x,d,v,r,c,s,A,I){return(nf.Actions=b(C,H,L,G,l,t,j,f,y,N,M,h,m,F,k,g,u,w,i,O,p,E,K,e,z,B,J,D,q,n,o,x,d,v,r,c,s,A,I))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Actions=b(require("jquery"),require("d3"),require("nf.CanvasUtils"),require("nf.Common"),require("nf.Dialog"),require("nf.Storage"),require("nf.Client"),require("nf.ErrorHandler"),require("nf.Clipboard"),require("nf.ParameterContexts"),require("nf.Snippet"),require("nf.GoTo"),require("nf.ng.Bridge"),require("nf.Shell"),require("nf.VariableRegistry"),require("nf.ComponentState"),require("nf.FlowVersion"),require("nf.Draggable"),require("nf.Birdseye"),require("nf.Connection"),require("nf.Graph"),require("nf.ProcessGroupConfiguration"),require("nf.ProcessorConfiguration"),require("nf.ProcessorDetails"),require("nf.LabelConfiguration"),require("nf.RemoteProcessGroupConfiguration"),require("nf.RemoteProcessGroupDetails"),require("nf.PortConfiguration"),require("nf.PortDetails"),require("nf.ConnectionConfiguration"),require("nf.ConnectionDetails"),require("nf.PolicyManagement"),require("nf.RemoteProcessGroup"),require("nf.Label"),require("nf.Processor"),require("nf.RemoteProcessGroupPorts"),require("nf.ComponentVersion"),require("nf.QueueListing"),require("nf.StatusHistory")))}else{nf.Actions=b(a.$,a.d3,a.nf.CanvasUtils,a.nf.Common,a.nf.Dialog,a.nf.Storage,a.nf.Client,a.nf.ErrorHandler,a.nf.Clipboard,a.nf.ParameterContexts,a.nf.Snippet,a.nf.GoTo,a.nf.ng.Bridge,a.nf.Shell,a.nf.VariableRegistry,a.nf.ComponentState,a.nf.FlowVersion,a.nf.Draggable,a.nf.Birdseye,a.nf.Connection,a.nf.Graph,a.nf.ProcessGroupConfiguration,a.nf.ProcessorConfiguration,a.nf.ProcessorDetails,a.nf.LabelConfiguration,a.nf.RemoteProcessGroupConfiguration,a.nf.RemoteProcessGroupDetails,a.nf.PortConfiguration,a.nf.PortDetails,a.nf.ConnectionConfiguration,a.nf.ConnectionDetails,a.nf.PolicyManagement,a.nf.RemoteProcessGroup,a.nf.Label,a.nf.Processor,a.nf.RemoteProcessGroupPorts,a.nf.ComponentVersion,a.nf.QueueListing,a.nf.StatusHistory)}}}(this,function(F,L,P,K,m,v,k,f,B,R,Q,h,o,J,l,g,w,y,i,S,r,H,O,c,C,E,N,G,s,p,q,A,b,x,t,a,u,D,M){var I={urls:{api:"../nifi-api",controller:"../nifi-api/controller",parameterContexts:"../nifi-api/parameter-contexts",downloadToken:"../nifi-api/access/download-token"}};var e=function(){F("#drop-request-status-dialog").modal({scrollableContentStyle:"scrollable",handler:{close:function(){F("#drop-request-status-dialog").modal("setButtonModel",[])}}})};var n=function(U,T){T.disconnectedNodeAcknowledged=v.isDisconnectionAcknowledged();return F.ajax({type:"PUT",url:U,data:JSON.stringify(T),dataType:"json",contentType:"application/json"}).fail(function(X,V,W){m.showOkDialog({headerText:"Update Resource",dialogContent:K.escapeHtml(X.responseText)})})};var j=function(T){F.ajax({type:"GET",url:I.urls.api+"/flow/process-groups/"+encodeURIComponent(T.id),dataType:"json"}).done(function(U){r.set(U.processGroupFlow.flow)})};var d=function(T,U){return U.filter(function(V){return P.getConnectionSourceComponentId(T)===V.id}).size()>0};var z={init:function(){e()},enterGroup:function(T){if(T.size()===1&&P.isProcessGroup(T)){var U=T.datum();P.getComponentByType("ProcessGroup").enterGroup(U.id)}},leaveGroup:function(){P.getComponentByType("ProcessGroup").enterGroup(P.getParentGroupId())},refreshRemoteFlow:function(U){if(U.size()===1&&P.isRemoteProcessGroup(U)){var X=U.datum();var Y=X.component.flowRefreshed;var T=function(Z){X.component.flowRefreshed=Z;if(U.classed("visible")){U.select("text.remote-process-group-last-refresh").text(function(){return Z})}};var W=function(Z){F.ajax({type:"GET",url:X.uri,dataType:"json"}).done(function(aa){var ac=aa.component;if(Y===ac.flowRefreshed){V(Z)}else{b.set(aa);var ab=S.getComponentConnections(ac.id);F.each(ab,function(ae,ad){if(ad.permissions.canRead){S.reload(ad.id)}})}})};var V=function(Z){if(Z<=32){setTimeout(function(){W(Z*2)},Z*1000)}else{T(Y)}};T("Refreshing...");W(1)}},openUri:function(T){if(T.size()===1&&P.isRemoteProcessGroup(T)){var V=T.datum();var U=V.component.targetUri;if(!K.isBlank(U)){window.open(encodeURI(U))}else{m.showOkDialog({headerText:"Remote Process Group",dialogContent:"No target URI defined."})}}},showSource:function(T){if(T.size()===1&&P.isConnection(T)){var V=T.datum();if(V.sourceGroupId===P.getGroupId()){var U=L.select("#id-"+V.sourceId);z.show(U)}else{if(V.sourceType==="REMOTE_OUTPUT_PORT"){var W=L.select("#id-"+V.sourceGroupId);z.show(W)}else{P.showComponent(V.sourceGroupId,V.sourceId)}}}},showDestination:function(V){if(V.size()===1&&P.isConnection(V)){var W=V.datum();if(W.destinationGroupId===P.getGroupId()){var T=L.select("#id-"+W.destinationId);z.show(T)}else{if(W.destinationType==="REMOTE_INPUT_PORT"){var U=L.select("#id-"+W.destinationGroupId);z.show(U)}else{P.showComponent(W.destinationGroupId,W.destinationId)}}}},showDownstream:function(T){if(T.size()===1&&!P.isConnection(T)){if(P.isProcessor(T)){h.showDownstreamFromProcessor(T)}else{if(P.isFunnel(T)){h.showDownstreamFromFunnel(T)}else{if(P.isInputPort(T)){h.showDownstreamFromInputPort(T)}else{if(P.isOutputPort(T)){h.showDownstreamFromOutputPort(T)}else{if(P.isProcessGroup(T)||P.isRemoteProcessGroup(T)){h.showDownstreamFromGroup(T)}}}}}}},showUpstream:function(T){if(T.size()===1&&!P.isConnection(T)){if(P.isProcessor(T)){h.showUpstreamFromProcessor(T)}else{if(P.isFunnel(T)){h.showUpstreamFromFunnel(T)}else{if(P.isInputPort(T)){h.showUpstreamFromInputPort(T)}else{if(P.isOutputPort(T)){h.showUpstreamFromOutputPort(T)}else{if(P.isProcessGroup(T)||P.isRemoteProcessGroup(T)){h.showUpstreamFromGroup(T)}}}}}}},show:function(T){var U=P.getSelection();U.classed("selected",false);T.classed("selected",true);if(T.size()===1){z.center(T)}else{o.injector.get("navigateCtrl").zoomFit()}P.setURLParameters(P.getGroupId(),T);o.digest()},select:function(T){T.classed("selected",true)},selectAll:function(){z.select(L.selectAll("g.component, g.connection"))},center:function(V){if(V.size()===1){var W;if(P.isConnection(V)){var T,aa;var Z=V.datum();if(Z.bends.length>0){var U=Math.min(Math.max(0,Z.labelIndex),Z.bends.length-1);T=Z.bends[U].x;aa=Z.bends[U].y}else{T=(Z.start.x+Z.end.x)/2;aa=(Z.start.y+Z.end.y)/2}W={x:T,y:aa,width:1,height:1}}else{var X=V.datum();var Y=X.position;W={x:Y.x,y:Y.y,width:X.dimensions.width,height:X.dimensions.height}}P.centerBoundingBox(W)}},enable:function(U){if(U.empty()){var T={id:P.getGroupId(),state:"ENABLED"};n(I.urls.api+"/flow/process-groups/"+encodeURIComponent(P.getGroupId()),T).done(j)}else{var W=P.filterEnable(U);if(!W.empty()){var V=[];W.each(function(aa){var Y=L.select(this);var Z,X;if(P.isProcessGroup(Y)){Z=I.urls.api+"/flow/process-groups/"+encodeURIComponent(aa.id);X={id:aa.id,state:"ENABLED"}}else{Z=aa.uri+"/run-status";X={revision:k.getRevision(aa),state:"STOPPED"}}V.push(n(Z,X).done(function(ab){if(P.isProcessGroup(Y)){P.getComponentByType("ProcessGroup").reload(aa.id)}else{P.getComponentByType(aa.type).set(ab)}}))});if(V.length>0){F.when.apply(window,V).always(function(){o.digest()})}}}},disable:function(V){if(V.empty()){var U={id:P.getGroupId(),state:"DISABLED"};n(I.urls.api+"/flow/process-groups/"+encodeURIComponent(P.getGroupId()),U).done(j)}else{var T=P.filterDisable(V);if(!T.empty()){var W=[];T.each(function(aa){var Y=L.select(this);var Z,X;if(P.isProcessGroup(Y)){Z=I.urls.api+"/flow/process-groups/"+encodeURIComponent(aa.id);X={id:aa.id,state:"DISABLED"}}else{Z=aa.uri+"/run-status";X={revision:k.getRevision(aa),state:"DISABLED"}}W.push(n(Z,X).done(function(ab){if(P.isProcessGroup(Y)){P.getComponentByType("ProcessGroup").reload(aa.id)}else{P.getComponentByType(aa.type).set(ab)}}))});if(W.length>0){F.when.apply(window,W).always(function(){o.digest()})}}}},openProvenance:function(T){if(T.size()===1){var U=T.datum();J.showPage("provenance?"+F.param({componentId:U.id}))}},start:function(V){if(V.empty()){var T={id:P.getGroupId(),state:"RUNNING"};n(I.urls.api+"/flow/process-groups/"+encodeURIComponent(P.getGroupId()),T).done(j)}else{var W=V.filter(function(X){return P.isRunnable(L.select(this))});if(!W.empty()){var U=[];W.each(function(aa){var Y=L.select(this);var Z,X;if(P.isProcessGroup(Y)){Z=I.urls.api+"/flow/process-groups/"+encodeURIComponent(aa.id);X={id:aa.id,state:"RUNNING"}}else{Z=aa.uri+"/run-status";X={revision:k.getRevision(aa),state:"RUNNING"}}U.push(n(Z,X).done(function(ab){if(P.isProcessGroup(Y)){P.getComponentByType("ProcessGroup").reload(aa.id)}else{P.getComponentByType(aa.type).set(ab)}}))});if(U.length>0){F.when.apply(window,U).always(function(){o.digest()})}}}},stop:function(V,T){if(V.empty()){var U={id:P.getGroupId(),state:"STOPPED"};n(I.urls.api+"/flow/process-groups/"+encodeURIComponent(P.getGroupId()),U).done(j)}else{var X=V.filter(function(Y){return P.isStoppable(L.select(this))});if(!X.empty()){var W=[];X.each(function(ab){var Z=L.select(this);var aa,Y;if(P.isProcessGroup(Z)){aa=I.urls.api+"/flow/process-groups/"+encodeURIComponent(ab.id);Y={id:ab.id,state:"STOPPED"}}else{aa=ab.uri+"/run-status";Y={revision:k.getRevision(ab),state:"STOPPED"}}W.push(n(aa,Y).done(function(ac){if(P.isProcessGroup(Z)){P.getComponentByType("ProcessGroup").reload(ab.id)}else{P.getComponentByType(ab.type).set(ac)}}))});if(W.length>0){F.when.apply(window,W).always(function(){o.digest();if(typeof T=="function"){T()}})}else{if(typeof T=="function"){T()}}}}},stopAndConfigure:function(U,T){if(U.size()===1&&P.isProcessor(U)&&P.canModify(U)){z.stop(U,function(){O.showConfiguration(U,T)})}},terminate:function(U,T){if(U.size()===1&&P.isProcessor(U)){var V=U.datum();F.ajax({type:"DELETE",url:V.uri+"/threads",dataType:"json"}).done(function(W){t.set(W);if(typeof T=="function"){T()}}).fail(f.handleAjaxError)}},enableTransmission:function(T){var U=T.filter(function(V){return P.canStartTransmitting(L.select(this))});U.each(function(W){var V={revision:k.getRevision(W),state:"TRANSMITTING"};n(W.uri+"/run-status",V).done(function(X){b.set(X)})})},disableTransmission:function(U){var T=U.filter(function(V){return P.canStopTransmitting(L.select(this))});T.each(function(W){var V={revision:k.getRevision(W),state:"STOPPED"};n(W.uri+"/run-status",V).done(function(X){b.set(X)})})},showConfiguration:function(U,T){if(U.empty()){H.showConfiguration(P.getGroupId())}else{if(U.size()===1){var V=U.datum();if(P.isProcessor(U)){O.showConfiguration(U,T)}else{if(P.isLabel(U)){C.showConfiguration(U)}else{if(P.isProcessGroup(U)){H.showConfiguration(V.id)}else{if(P.isRemoteProcessGroup(U)){E.showConfiguration(U)}else{if(P.isInputPort(U)||P.isOutputPort(U)){G.showConfiguration(U)}else{if(P.isConnection(U)){p.showConfiguration(U)}}}}}}}}},managePolicies:function(T){if(T.size()<=1){A.showComponentPolicy(T)}},showDetails:function(T){if(T.empty()){H.showConfiguration(P.getGroupId())}else{if(T.size()===1){var U=T.datum();if(P.isProcessor(T)){if(!P.isStoppable(T)&&P.canModify(T)){O.showConfiguration(T)}else{c.showDetails(P.getGroupId(),U.id)}}else{if(P.isProcessGroup(T)){H.showConfiguration(U.id)}else{if(P.isRemoteProcessGroup(T)){N.showDetails(T)}else{if(P.isInputPort(T)||P.isOutputPort(T)){s.showDetails(T)}else{if(P.isConnection(T)){q.showDetails(P.getGroupId(),U.id)}}}}}}}},showUsage:function(T){if(T.size()===1&&P.isProcessor(T)){var U=T.datum();J.showPage("../nifi-docs/documentation?"+F.param({select:U.component.type,group:U.component.bundle.group,artifact:U.component.bundle.artifact,version:U.component.bundle.version}))}},showStats:function(T){if(T.size()===1){var U=T.datum();if(P.isProcessor(T)){M.showProcessorChart(P.getGroupId(),U.id)}else{if(P.isProcessGroup(T)){M.showProcessGroupChart(P.getGroupId(),U.id)}else{if(P.isRemoteProcessGroup(T)){M.showRemoteProcessGroupChart(P.getGroupId(),U.id)}else{if(P.isConnection(T)){M.showConnectionChart(P.getGroupId(),U.id)}}}}}},remotePorts:function(T){if(T.size()===1&&P.isRemoteProcessGroup(T)){a.showPorts(T)}},reload:function(){P.reload()},"delete":function(V){if(K.isUndefined(V)||V.empty()){m.showOkDialog({headerText:"Delete Components",dialogContent:"No eligible components are selected. Please select the components to be deleted."})}else{if(V.size()===1){var X=V.datum();var U=k.getRevision(X);F.ajax({type:"DELETE",url:X.uri+"?"+F.param({version:U.version,clientId:U.clientId,disconnectedNodeAcknowledged:v.isDisconnectionAcknowledged()}),dataType:"json"}).done(function(Y){P.getComponentByType(X.type).remove(X.id);if(P.isConnection(V)===false){var Z=S.getComponentConnections(X.id);if(Z.length>0){var aa=[];F.each(Z,function(ac,ab){aa.push(ab.id)});S.remove(aa)}}P.setURLParameters();i.refresh();o.digest()}).fail(f.handleAjaxError)}else{var T=P.getGroupId();var W=Q.marshal(V,T);Q.create(W).done(function(Y){Q.remove(Y.snippet.id).done(function(){var aa=L.map();var Z=function(ab,ac){if(!aa.has(ab)){aa.set(ab,[])}aa.get(ab).push(ac)};V.each(function(ac){Z(ac.type,ac.id);if(ac.type!=="Connection"){var ab=S.getComponentConnections(ac.id);if(ab.length>0){F.each(ab,function(ae,ad){Z("Connection",ad.id)})}}});aa.each(function(ac,ab){if(ab!=="Connection"){P.getComponentByType(ab).remove(ac)}});if(aa.has("Connection")){S.remove(aa.get("Connection"))}P.setURLParameters();i.refresh();o.digest()}).fail(f.handleAjaxError)}).fail(f.handleAjaxError)}}},emptyQueue:function(T){if(T.size()!==1||!P.isConnection(T)){return}m.showYesNoDialog({headerText:"Empty Queue",dialogContent:"Are you sure you want to empty this queue? All FlowFiles waiting at the time of the request will be removed.",noText:"Cancel",yesText:"Empty",yesHandler:function(){var X=T.datum();var ab=4;var Z=false;var aa=null;var W=null;var V=function(ae){var af=F("#drop-request-percent-complete");af.find("div.progress-label").remove();af.find("md-progress-linear").remove();var ad=F('<div class="progress-label"></div>').text(ae+"%");(o.injector.get("$compile")(F('<md-progress-linear ng-cloak ng-value="'+ae+'" class="md-hue-2" md-mode="determinate" aria-label="Drop request percent complete"></md-progress-linear>'))(o.rootScope)).appendTo(af);af.append(ad)};F("#drop-request-status-dialog").modal("setButtonModel",[{buttonText:"Stop",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){Z=true;if(W!==null){clearTimeout(W);U()}}}}]);var U=function(){S.reloadStatus(X.id);if(K.isDefinedAndNotNull(aa)){F.ajax({type:"DELETE",url:aa.uri,dataType:"json"}).done(function(ad){aa=ad.dropRequest;var ag=aa.dropped.split(/ \/ /);var af=F("<div></div>");F('<span class="label"></span>').text(ag[0]).appendTo(af);F("<span></span>").text(" FlowFiles ("+ag[1]+")").appendTo(af);if(aa.percentCompleted<100){var ae=aa.original.split(/ \/ /);F('<span class="label"></span>').text(" out of "+ae[0]).appendTo(af);F("<span></span>").text(" ("+ae[1]+")").appendTo(af)}F("<span></span>").text(" were removed from the queue.").appendTo(af);if(K.isDefinedAndNotNull(aa.failureReason)){F("<br/><br/><span></span>").text(aa.failureReason).appendTo(af)}m.showOkDialog({headerText:"Empty Queue",dialogContent:af})}).always(function(){F("#drop-request-status-dialog").modal("hide")})}else{m.showOkDialog({headerText:"Empty Queue",dialogContent:"No FlowFiles were removed."});F("#drop-request-status-dialog").modal("hide")}};var ac=function(ad){V(aa.percentCompleted);F("#drop-request-status-message").text(aa.state);if(aa.finished===true||Z===true){U()}else{W=setTimeout(function(){W=null;Y(Math.min(ab,ad*2))},ad*1000)}};var Y=function(ad){F.ajax({type:"GET",url:aa.uri,dataType:"json"}).done(function(ae){aa=ae.dropRequest;ac(ad)}).fail(function(ag,ae,af){if(ag.status===403){f.handleAjaxError(ag,ae,af)}else{U()}})};F.ajax({type:"POST",url:"../nifi-api/flowfile-queues/"+encodeURIComponent(X.id)+"/drop-requests",dataType:"json",contentType:"application/json"}).done(function(ad){V(0);F("#drop-request-status-dialog").modal("show");aa=ad.dropRequest;ac(1)}).fail(function(af,ad,ae){if(af.status===403){f.handleAjaxError(af,ad,ae)}else{U()}})}})},emptyAllQueues:function(T){m.showYesNoDialog({headerText:"Empty All Queues",dialogContent:"Are you sure you want to empty all queues in this Process Group? All FlowFiles from all connections waiting at the time of the request will be removed.",noText:"Cancel",yesText:"Empty All",yesHandler:function(){var X;if(T.empty()){X=P.getGroupId()}else{X=T.datum().id}var ab=4;var Z=false;var aa=null;var W=null;var V=function(ae){var af=F("#drop-request-percent-complete");af.find("div.progress-label").remove();af.find("md-progress-linear").remove();var ad=F('<div class="progress-label"></div>').text(ae+"%");(o.injector.get("$compile")(F('<md-progress-linear ng-cloak ng-value="'+ae+'" class="md-hue-2" md-mode="determinate" aria-label="Drop request percent complete"></md-progress-linear>'))(o.rootScope)).appendTo(af);af.append(ad)};F("#drop-request-status-dialog").modal("setButtonModel",[{buttonText:"Stop",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){Z=true;if(W!==null){clearTimeout(W);U()}}}}]);var U=function(){P.reload();if(K.isDefinedAndNotNull(aa)){F.ajax({type:"DELETE",url:aa.uri,dataType:"json"}).done(function(ad){aa=ad.dropRequest;var ag=aa.dropped.split(/ \/ /);var af=F("<div></div>");F('<span class="label"></span>').text(ag[0]).appendTo(af);F("<span></span>").text(" FlowFiles ("+ag[1]+")").appendTo(af);if(aa.percentCompleted<100){var ae=aa.original.split(/ \/ /);F('<span class="label"></span>').text(" out of "+ae[0]).appendTo(af);F("<span></span>").text(" ("+ae[1]+")").appendTo(af)}F("<span></span>").text(" were removed from the queues.").appendTo(af);if(K.isDefinedAndNotNull(aa.failureReason)){F("<br/><br/><span></span>").text(aa.failureReason).appendTo(af)}m.showOkDialog({headerText:"Empty All Queues",dialogContent:af})}).always(function(){F("#drop-request-status-dialog").modal("hide")})}else{m.showOkDialog({headerText:"Empty All Queues",dialogContent:"No FlowFiles were removed."});F("#drop-request-status-dialog").modal("hide")}};var ac=function(ad){V(aa.percentCompleted);F("#drop-request-status-message").text(aa.state);if(aa.finished===true||Z===true){U()}else{W=setTimeout(function(){W=null;Y(Math.min(ab,ad*2))},ad*1000)}};var Y=function(ad){F.ajax({type:"GET",url:aa.uri,dataType:"json"}).done(function(ae){aa=ae.dropRequest;ac(ad)}).fail(function(ag,ae,af){if(ag.status===403){f.handleAjaxError(ag,ae,af)}else{U()}})};F.ajax({type:"POST",url:"../nifi-api/process-groups/"+encodeURIComponent(X)+"/empty-all-connections-requests",dataType:"json",contentType:"application/json"}).done(function(ad){V(0);F("#drop-request-status-dialog").modal("show");aa=ad.dropRequest;ac(1)}).fail(function(af,ad,ae){if(af.status===403){f.handleAjaxError(af,ad,ae)}else{U()}})}})},listQueue:function(U){if(U.size()!==1||!P.isConnection(U)){return}var T=U.datum();D.listQueue(T)},viewState:function(U){if(U.size()!==1||!P.isProcessor(U)){return}var T=U.datum();g.showState(T,P.isConfigurable(U))},saveFlowVersion:function(T){if(T.empty()){w.showFlowVersionDialog(P.getGroupId(),"COMMIT")}else{if(T.size()===1){var U=T.datum();if(P.isProcessGroup(T)){w.showFlowVersionDialog(U.id,"COMMIT")}}}},forceSaveFlowVersion:function(T){m.showYesNoDialog({headerText:"Commit",dialogContent:"Committing will ignore available upgrades and commit local changes as the next version. Are you sure you want to proceed?",noText:"Cancel",yesText:"Yes",yesHandler:function(){if(T.empty()){w.showFlowVersionDialog(P.getGroupId(),"FORCE_COMMIT")}else{if(T.size()===1){var U=T.datum();if(P.isProcessGroup(T)){w.showFlowVersionDialog(U.id,"FORCE_COMMIT")}}}}})},revertLocalChanges:function(T){if(T.empty()){w.revertLocalChanges(P.getGroupId())}else{if(T.size()===1){var U=T.datum();w.revertLocalChanges(U.id)}}},showLocalChanges:function(T){if(T.empty()){w.showLocalChanges(P.getGroupId())}else{if(T.size()===1){var U=T.datum();w.showLocalChanges(U.id)}}},changeFlowVersion:function(T){if(T.empty()){w.showChangeFlowVersionDialog(P.getGroupId())}else{if(T.size()===1){var U=T.datum();if(P.isProcessGroup(T)){w.showChangeFlowVersionDialog(U.id)}}}},downloadFlow:function(U){var T=null;if(U.empty()){T=P.getGroupId()}else{if(U.size()===1){var V=U.datum();if(P.isProcessGroup(U)){T=V.id}}}if(T!==null){K.getAccessToken(I.urls.downloadToken).done(function(W){var Y={};if(!K.isBlank(W)){Y.access_token=W}var X="../nifi-api/process-groups/"+encodeURIComponent(T)+"/download";if(!F.isEmptyObject(Y)){X+=("?"+F.param(Y))}window.open(X)}).fail(function(){m.showOkDialog({headerText:"Download Flow",dialogContent:"Unable to generate access token for downloading content."})})}},stopVersionControl:function(T){if(T.empty()){w.stopVersionControl(P.getGroupId())}else{if(T.size()===1){var U=T.datum();w.stopVersionControl(U.id)}}},openVariableRegistry:function(T){if(T.empty()){l.showVariables(P.getGroupId())}else{if(T.size()===1){var U=T.datum();if(P.isProcessGroup(T)){l.showVariables(U.id)}}}},openParameterContext:function(T){var U;if(T.empty()){U=P.getParameterContext()}else{if(T.size()===1){if(P.isProcessGroup(T)){var V=T.datum();U=V.parameterContext}}}if(K.isDefinedAndNotNull(U)){R.showParameterContext(U.id)}},changeVersion:function(U){if(U.size()!==1||!P.isProcessor(U)){return}var T=U.datum();u.promptForVersionChange(T)},alignVertical:function(V){var X=L.map();if(P.canModify(V)===false){m.showOkDialog({headerText:"Component Position",dialogContent:"Must be authorized to modify every component selected."});return}var U=null,W=null;V.each(function(Z){if(Z.type!=="Connection"){if(U===null||Z.position.x<U){U=Z.position.x}var Y=Z.position.x+Z.dimensions.width;if(W===null||Y>W){W=Y}}});var T=(U+W)/2;V.each(function(Z){if(Z.type!=="Connection"){var aa={x:T-(Z.position.x+Z.dimensions.width/2),y:0};if(aa.x!==0){var Y=S.getComponentConnections(Z.id);F.each(Y,function(ad,ac){var ae=L.select("#id-"+ac.id);if(!X.has(ac.id)&&P.getConnectionSourceComponentId(ac)===P.getConnectionDestinationComponentId(ac)){var ab=y.updateConnectionPosition(S.get(ac.id),aa);if(ab!==null){X.set(ac.id,ab)}}else{if(!X.has(ac.id)&&ae.classed("selected")&&P.canModify(ae)){if(P.getConnectionSourceComponentId(ac)===Z.id||!d(ac,V)){var ab=y.updateConnectionPosition(S.get(ac.id),aa);if(ab!==null){X.set(ac.id,ab)}}}}});X.set(Z.id,y.updateComponentPosition(Z,aa))}}});y.refreshConnections(X)},alignHorizontal:function(U){var W=L.map();if(P.canModify(U)===false){m.showOkDialog({headerText:"Component Position",dialogContent:"Must be authorized to modify every component selected."});return}var X=null,V=null;U.each(function(Z){if(Z.type!=="Connection"){if(X===null||Z.position.y<X){X=Z.position.y}var Y=Z.position.y+Z.dimensions.height;if(V===null||Y>V){V=Y}}});var T=(X+V)/2;U.each(function(Z){if(Z.type!=="Connection"){var aa={x:0,y:T-(Z.position.y+Z.dimensions.height/2)};if(aa.y!==0){var Y=S.getComponentConnections(Z.id);F.each(Y,function(ad,ac){var ae=L.select("#id-"+ac.id);if(!W.has(ac.id)&&P.getConnectionSourceComponentId(ac)===P.getConnectionDestinationComponentId(ac)){var ab=y.updateConnectionPosition(S.get(ac.id),aa);if(ab!==null){W.set(ac.id,ab)}}else{if(!W.has(ac.id)&&ae.classed("selected")&&P.canModify(ae)){if(P.getConnectionSourceComponentId(ac)===Z.id||!d(ac,U)){var ab=y.updateConnectionPosition(S.get(ac.id),aa);if(ab!==null){W.set(ac.id,ab)}}}}});W.set(Z.id,y.updateComponentPosition(Z,aa))}}});y.refreshConnections(W)},fillColor:function(V){if(P.isColorable(V)){var T=P.isProcessor(V);var U;if(T){U=t.defaultFillColor()}else{U=x.defaultColor()}if(V.size()===1){var W=V.datum();if(K.isDefinedAndNotNull(W.component.style["background-color"])){U=W.component.style["background-color"]}}F("#fill-color").minicolors("value",U);if(T){F("#fill-color-processor-preview").show();F("#fill-color-label-preview").hide()}else{F("#fill-color-processor-preview").hide();F("#fill-color-label-preview").show()}F("#fill-color-dialog").modal("show")}},group:function(){var U=P.getSelection();if(U.empty()){return}var T=P.getOrigin(U);var V={x:T.x,y:T.y};F.when(o.injector.get("groupComponent").promptForGroupName(V,false)).done(function(W){var X=L.select("#id-"+W.id);P.moveComponents(U,X)})},moveIntoParent:function(){var T=P.getSelection();if(T.empty()){return}P.moveComponentsToParent(T)},uploadTemplate:function(){F("#upload-template-dialog").modal("show")},template:function(){var T=P.getSelection();if(T.empty()){T=L.selectAll("g.component, g.connection")}if(T.empty()){m.showOkDialog({headerText:"Create Template",dialogContent:"The current selection is not valid to create a template."});return}T=P.trimDanglingEdges(T);if(T.empty()){m.showOkDialog({headerText:"Create Template",dialogContent:"The current selection is not valid to create a template."});return}F("#new-template-dialog").modal("setButtonModel",[{buttonText:"Create",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var V=F("#new-template-name").val();if(K.isBlank(V)){m.showOkDialog({headerText:"Configuration Error",dialogContent:"The name of the template must be specified."});return}F("#new-template-dialog").modal("hide");var X=F("#new-template-description").val();var U=P.getGroupId();var W=Q.marshal(T,U);Q.create(W).done(function(Y){var Z={name:V,description:X,snippetId:Y.snippet.id,disconnectedNodeAcknowledged:v.isDisconnectionAcknowledged()};F.ajax({type:"POST",url:I.urls.api+"/process-groups/"+encodeURIComponent(P.getGroupId())+"/templates",data:JSON.stringify(Z),dataType:"json",contentType:"application/json"}).done(function(){m.showOkDialog({headerText:"Create Template",dialogContent:"Template '"+K.escapeHtml(V)+"' was successfully created."})}).always(function(){F("#new-template-name").val("");F("#new-template-description").val("")}).fail(f.handleAjaxError)}).fail(f.handleAjaxError)}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){F("#new-template-name").val("");F("#new-template-description").val("");F("#new-template-dialog").modal("hide")}}}]).modal("show");F("#new-template-name").focus()},copy:function(W){if(W.empty()){return}var U=P.getOrigin(W);var V=P.getSelectionBoundingClientRect(W);var T=P.getGroupId();B.copy({snippet:Q.marshal(W,T),origin:U,dimensions:V})},paste:function(aa,ab){if(K.isDefinedAndNotNull(ab)){var V=P.getCanvasScale();var T=P.getCanvasTranslate();var W=ab.pageX;var U=ab.pageY-P.getCanvasOffset();var Z=(W/V)-(T[0]/V);var Y=(U/V)-(T[1]/V);var X={x:Z,y:Y}}B.paste().done(function(ad){var ac=F.Deferred(function(ae){var af=function(aj,ah,ai){ae.reject(aj.responseText)};var ag=P.getGroupId();Q.create(ad.snippet).done(function(ak){var aj=X;var ai=ad.origin;var al=ad.dimensions;if(!K.isDefinedAndNotNull(aj)){if(P.getGroupId()!==ad.snippet.parentGroupId||!P.isBoundingBoxInViewport(al,false)){var an=P.getCanvasScale();var ah=P.getCenterForBoundingBox(al);var am=P.getCanvasTranslate();aj={x:ah[0]-(am[0]/an),y:ah[1]-(am[1]/an)}}else{ai.x+=25;ai.y+=25;aj=ai}}Q.copy(ak.snippet.id,aj,ag).done(function(ap){var ao=ap.flow;r.add(ao,{selectAll:true});r.updateVisibility();i.refresh()}).fail(function(){P.reload().done(function(){r.updateVisibility();i.refresh()})}).fail(af)}).fail(af)}).promise();ac.fail(function(af){var ae="An error occurred while attempting to copy and paste.";if(F.trim(af)!==""){ae=af}m.showOkDialog({headerText:"Paste Error",dialogContent:K.escapeHtml(ae)})})})},toFront:function(W){if(W.size()!==1||!P.isConnection(W)){return}var T=W.datum();var V=-1;F.each(S.get(),function(Y,Z){if(T.id!==Z.id&&Z.zIndex>V){V=Z.zIndex}});if(V>=0){var X=V+1;var U={revision:k.getRevision(T),disconnectedNodeAcknowledged:v.isDisconnectionAcknowledged(),component:{id:T.id,zIndex:X}};F.ajax({type:"PUT",url:T.uri,data:JSON.stringify(U),dataType:"json",contentType:"application/json"}).done(function(Y){S.set(Y)}).fail(f.handleAjaxError)}}};return z}));
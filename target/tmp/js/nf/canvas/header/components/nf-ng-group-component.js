(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Client","nf.Birdseye","nf.Storage","nf.Graph","nf.CanvasUtils","nf.ErrorHandler","nf.Common","nf.Dialog"],function(g,k,c,h,i,e,j,d,f){return(nf.ng.GroupComponent=b(g,k,c,h,i,e,j,d,f))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.GroupComponent=b(require("jquery"),require("nf.Client"),require("nf.Birdseye"),require("nf.Storage"),require("nf.Graph"),require("nf.CanvasUtils"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.Dialog")))}else{nf.ng.GroupComponent=b(a.$,a.nf.Client,a.nf.Birdseye,a.nf.Storage,a.nf.Graph,a.nf.CanvasUtils,a.nf.ErrorHandler,a.nf.Common,a.nf.Dialog)}}}(this,function(e,i,a,f,g,c,h,b,d){return function(m){var l=function(p,o){var n={revision:i.getRevision({revision:{version:0}}),disconnectedNodeAcknowledged:f.isDisconnectionAcknowledged(),component:{name:p,position:{x:o.x,y:o.y}}};return e.ajax({type:"POST",url:m.headerCtrl.toolboxCtrl.config.urls.api+"/process-groups/"+encodeURIComponent(c.getGroupId())+"/process-groups",data:JSON.stringify(n),dataType:"json",contentType:"application/json"}).done(function(q){g.add({processGroups:[q]},{selectAll:true});g.updateVisibility();a.refresh()}).fail(h.handleConfigurationUpdateAjaxError)};function j(){this.icon="icon icon-group";this.hoverIcon="icon icon-group-add";this.modal={getElement:function(){return e("#new-process-group-dialog")},init:function(){this.getElement().modal({scrollableContentStyle:"scrollable",headerText:"Add Process Group",handler:{close:function(){e("#new-process-group-name").val("");e("#new-process-group-dialog").removeData("pt")}}})},update:function(o,n){this.getElement().modal(o,n)},show:function(){this.getElement().modal("show")},storePt:function(n){e("#new-process-group-dialog").data("pt",n)},hide:function(){this.getElement().modal("hide")}}}j.prototype={constructor:j,getElement:function(){return e("#group-component")},enabled:function(){this.getElement().attr("disabled",false)},disabled:function(){this.getElement().attr("disabled",true)},dropHandler:function(n){this.promptForGroupName(n,true)},dragIcon:function(n){return e('<div class="icon icon-group-add"></div>')},promptForGroupName:function(o,p){var n=this;return e.Deferred(function(q){var r=function(){var s=e("#new-process-group-name").val();if(b.isBlank(s)){d.showOkDialog({headerText:"Configuration Error",dialogContent:"The name of the process group must be specified."});q.reject()}else{n.modal.hide();l(s,o).done(function(t){q.resolve(t.component)}).fail(function(){q.reject()})}};n.modal.update("setButtonModel",[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:r}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){q.reject();n.modal.hide()}}}]);if(p===true&&b.canVersionFlows()){e("#import-process-group-link").show()}else{e("#import-process-group-link").hide()}n.modal.storePt(o);n.modal.show();e("#new-process-group-name").focus().off("keyup").on("keyup",function(t){var s=t.keyCode?t.keyCode:t.which;if(s===e.ui.keyCode.ENTER){r()}})}).promise()}};var k=new j();return k}}));
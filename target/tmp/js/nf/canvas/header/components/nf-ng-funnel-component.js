(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Client","nf.Birdseye","nf.Storage","nf.Graph","nf.CanvasUtils","nf.ErrorHandler"],function(h,e,g,d,c,f,i){return(nf.ng.FunnelComponent=b(h,e,g,d,c,f,i))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.FunnelComponent=b(require("jquery"),require("nf.Client"),require("nf.Birdseye"),require("nf.Storage"),require("nf.Graph"),require("nf.CanvasUtils"),require("nf.ErrorHandler")))}else{nf.ng.FunnelComponent=b(a.$,a.nf.Client,a.nf.Birdseye,a.nf.Storage,a.nf.Graph,a.nf.CanvasUtils,a.nf.ErrorHandler)}}}(this,function(f,c,e,b,a,d,g){return function(i){function h(){this.icon="icon icon-funnel";this.hoverIcon="icon icon-funnel-add"}h.prototype={constructor:h,getElement:function(){return f("#funnel-component")},enabled:function(){this.getElement().attr("disabled",false)},disabled:function(){this.getElement().attr("disabled",true)},dropHandler:function(k){this.createFunnel(k)},dragIcon:function(k){return f('<div class="icon icon-funnel-add"></div>')},createFunnel:function(l){var k={revision:c.getRevision({revision:{version:0}}),disconnectedNodeAcknowledged:b.isDisconnectionAcknowledged(),component:{position:{x:l.x,y:l.y}}};f.ajax({type:"POST",url:i.headerCtrl.toolboxCtrl.config.urls.api+"/process-groups/"+encodeURIComponent(d.getGroupId())+"/funnels",data:JSON.stringify(k),dataType:"json",contentType:"application/json"}).done(function(m){a.add({funnels:[m]},{selectAll:true});a.updateVisibility();e.refresh()}).fail(g.handleAjaxError)}};var j=new h();return j}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common","nf.Dialog","nf.SummaryTable"],function(d,e,c,f){return(nf.ClusterSearch=b(d,e,c,f))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ClusterSearch=b(require("jquery"),require("nf.Common"),require("nf.Dialog"),require("nf.SummaryTable")))}else{nf.ClusterSearch=b(a.$,a.nf.Common,a.nf.Dialog,a.nf.SummaryTable)}}}(this,function(c,d,b,e){var a={search:"Search nodes",urls:{clusterSearch:"../nifi-api/flow/cluster/search-results"}};return{init:function(){c("#view-single-node-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Select node",buttons:[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var f=c("#cluster-search-field").val();c.ajax({type:"GET",data:{q:f},dataType:"json",url:a.urls.clusterSearch}).done(function(g){var i=g.nodeResults;var h=function(k){e.setClusterNodeId(k.id);e.loadSummaryTable();c("#summary-header-text").text(k.address+" Summary")};if(!c.isArray(i)||i.length===0){b.showOkDialog({headerText:"Cluster Search",dialogContent:"No nodes match '"+d.escapeHtml(f)+"'."})}else{if(i.length>1){var j=false;c.each(i,function(l,k){if(k.address===f){h(k);j=true;return false}});if(j){c("#view-single-node-dialog").modal("hide")}else{b.showOkDialog({headerText:"Cluster Search",dialogContent:"More than one node matches '"+d.escapeHtml(f)+"'."})}}else{if(i.length===1){h(i[0]);c("#view-single-node-dialog").modal("hide")}}}})}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){this.modal("hide")}}}],handler:{close:function(){c("#cluster-search-field").val(a.search).addClass("search-nodes").clusterSearchAutocomplete("reset")}}});c.widget("nf.clusterSearchAutocomplete",c.ui.autocomplete,{reset:function(){this.term=null},_create:function(){this._super();this.widget().menu("option","items","> :not(.search-no-matches)")},_normalize:function(g){var f=[];f.push(g);return f},_renderMenu:function(h,f){var i=f[0];var g=this;c.each(i.nodeResults,function(j,k){g._renderItem(h,{label:k.address,value:k.address})});if(h.children().length===0){h.append('<li class="unset search-no-matches">No nodes matched the search terms</li>')}},_resizeMenu:function(){var f=this.menu.element;f.width(c("#cluster-search-field").outerWidth()-2)},_renderItem:function(g,f){var h=c("<a></a>").text(f.label);return c("<li></li>").data("ui-autocomplete-item",f).append(h).appendTo(g)}});c("#cluster-search-field").clusterSearchAutocomplete({minLength:0,appendTo:"#search-cluster-results",position:{my:"left top",at:"left bottom",offset:"0 1"},source:function(g,f){c.ajax({type:"GET",data:{q:g.term},dataType:"json",url:a.urls.clusterSearch}).done(function(h){f(h)})}}).focus(function(){if(c(this).val()===a.search){c(this).val("").removeClass("search-nodes")}}).val(a.search).addClass("search-nodes");c("#view-single-node-link").click(function(){c("#view-single-node-dialog").modal("show");c("#cluster-search-field").focus()});c("#view-cluster-link").click(function(){e.setClusterNodeId(null);e.loadSummaryTable();c("#summary-header-text").text("NiFi Summary")});c("#view-options-container").show()}}}));